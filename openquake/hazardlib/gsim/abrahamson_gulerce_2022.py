# -*- coding: utf-8 -*-
# vim: tabstop=4 shiftwidth=4 softtabstop=4
#
# Copyright (C) 2015-2023 GEM Foundation
#
# OpenQuake is free software: you can redistribute it and/or modify it
# under the terms of the GNU Affero General Public License as published
# by the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# OpenQuake is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Affero General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with OpenQuake. If not, see <http://www.gnu.org/licenses/>.


"""
Module exports :class:`AbrahamsonGulerce2022SInter`,
               :class:`AbrahamsonGulerce2022SSlab`
"""
from openquake.hazardlib.gsim.base import GMPE, CoeffsTable, add_alias
from openquake.hazardlib.gsim import abrahamson_gulerce_2020


# Coefficients taken from Earthquake Spectra electronic supplement.
coeffs_2022 = CoeffsTable(sa_damping=5, table="""\
imt     c1i         a1      a2       a6     a7     a8    a10      a11     a12     a13    a14      a16  a17     a18  a19     a20    a21    a22    a23     a24      a25      a26      a27      a28       a29     a30       a31       a32       a33       a34       a35       a36       a37    a39     a41     d1     d2  rhoW   rhoB    vlin       b USA-AK_Adj    CAS_Adj  phi_s2s_g1  phi_s2s_g2   phi_s2s_g3      e1       e2      e3
PGA    8.20   4.731460  -1.450  -0.0043  3.210  0.044  3.210   0.0070   0.900       0  -0.46  0.09000    0  -0.200    0       0  0.040  0.040      0  0.0015   0.0007   0.0036  -0.0004  0.00250   0.00060  0.0033   3.77831   3.34676   3.80252   5.03612   4.62715   4.80444   3.56691      0  -0.029  0.325  0.137     1      1   865.1  -1.186   0.487221   0.827631       0.396       0.396        0.545   0.550   -0.270   0.050
0.010  8.20   4.731460  -1.450  -0.0043  3.210  0.044  3.210   0.0070   0.900       0  -0.46  0.09000    0  -0.200    0       0  0.040  0.040      0  0.0015   0.0007   0.0036  -0.0004  0.00250   0.00060  0.0033   3.77831   3.34676   3.80252   5.03612   4.62715   4.80444   3.56691      0  -0.029  0.325  0.137     1      1   865.1  -1.186   0.487221   0.827631       0.396       0.396        0.545   0.550   -0.270   0.050	
0.020  8.20   4.813005  -1.450  -0.0043  3.210  0.044  3.210   0.0070   1.008       0  -0.46  0.09000    0  -0.200    0       0  0.040  0.040      0  0.0015   0.0006   0.0036  -0.0005  0.00250   0.00050  0.0033   3.82805   3.44008   3.90532   5.13749   4.69578   4.89425   3.64249      0  -0.024  0.325  0.137  0.99  0.990   865.1  -1.219   0.518993   0.825354       0.396       0.396        0.545   0.550   -0.270   0.050	
0.030  8.20   4.912425  -1.450  -0.0044  3.210  0.044  3.210   0.0070   1.127       0  -0.46  0.09000    0  -0.200    0       0  0.040  0.040      0  0.0015   0.0006   0.0037  -0.0007  0.00250   0.00050  0.0034   3.89327   3.50871   4.01892   5.26986   4.78092   5.00277   3.70633      0  -0.034  0.325  0.137  0.99  0.990   907.8  -1.273   0.543041   0.833871       0.396       0.396        0.545   0.550   -0.270   0.050	
0.050  8.20   5.185226  -1.450  -0.0046  3.210  0.044  3.210   0.0070   1.333       0  -0.46  0.09000    0  -0.200    0       0  0.040  0.040      0  0.0011   0.0006   0.0039  -0.0009  0.00260   0.00040  0.0036   4.28670   3.65526   4.29520   5.61569   5.02105   5.28185   3.91843      0  -0.061  0.325  0.137  0.97  0.985  1053.5  -1.346   0.434604   0.895171       0.396       0.467        0.644   0.560   -0.270   0.050	
0.075  8.20   5.498929  -1.450  -0.0047  3.210  0.044  3.210   0.0070   1.565       0  -0.46  0.09000    0  -0.200    0       0  0.060  0.060      0  0.0011   0.0004   0.0039  -0.0009  0.00260   0.00030  0.0037   4.59402   3.97985   4.54636   6.02041   5.34740   5.61229   4.22072      0  -0.076  0.325  0.137  0.95  0.980  1085.7  -1.471   0.409907   0.863145       0.396       0.516        0.713   0.580   -0.270   0.050	
0.100  8.20   5.622073  -1.450  -0.0048  3.210  0.044  3.210   0.0070   1.679       0  -0.46  0.09000    0  -0.200    0       0  0.100  0.100      0  0.0012   0.0003   0.0039  -0.0008  0.00260   0.00030  0.0038   4.70773   4.13120   4.61378   6.16254   5.50651   5.76676   4.35356      0  -0.049  0.325  0.137  0.92  0.970  1032.5  -1.624   0.396663   0.841819       0.396       0.516        0.713   0.590   -0.270   0.050	
0.150  8.20   5.526701  -1.425  -0.0047  3.210  0.044  3.210   0.0070   1.853       0  -0.46  0.09000    0  -0.186    0  -0.055  0.135  0.135  0.069  0.0013  -0.0002   0.0037  -0.0009  0.00220   0.00010  0.0037   4.60650   4.27372   4.52897   5.96141   5.51804   5.73130   4.36641      0  -0.026  0.325  0.137  0.90  0.960   877.6  -1.931   0.428249   0.736665       0.396       0.516        0.647   0.590   -0.270   0.050	
0.200  8.20   5.060296  -1.335  -0.0045  3.210  0.043  3.210   0.0062   2.022       0  -0.46  0.08412    0  -0.150    0  -0.105  0.170  0.170  0.140  0.0013  -0.0007   0.0031  -0.0010  0.00180  -0.00010  0.0035   4.18660   3.96502   4.16560   5.39202   5.16680   5.29426   4.01685      0  -0.011  0.325  0.137  0.87  0.940   748.2  -2.188   0.441502   0.746068       0.396       0.516        0.596   0.570   -0.270   0.050	
0.250  8.20   4.739528  -1.275  -0.0043  3.210  0.042  3.210   0.0056   2.181       0  -0.46  0.08038    0  -0.140    0  -0.134  0.170  0.170  0.164  0.0013  -0.0009   0.0027  -0.0011  0.00155  -0.00030  0.0033   3.85147   3.68208   3.91471   5.01168   4.87436   5.00579   3.75904  0.101  -0.009  0.325  0.137  0.84  0.930   654.3  -2.381   0.493708   0.796017       0.396       0.501        0.539   0.530   -0.224   0.043	
0.300  8.20   4.511563  -1.231  -0.0042  3.210  0.041  3.210   0.0051   2.281  -0.002  -0.46  0.07800    0  -0.120    0  -0.150  0.170  0.170  0.190  0.0014  -0.0010   0.0020  -0.0009  0.00140  -0.00020  0.0032   3.57825   3.54150   3.78463   4.70573   4.65440   4.75879   3.59143  0.184   0.005  0.325  0.137  0.82  0.910   587.1  -2.518   0.564926   0.781579       0.396       0.488        0.488   0.490   -0.186   0.037	
0.400  8.20   4.192345  -1.165  -0.004   3.210  0.040  3.210   0.0043   2.379  -0.007  -0.47  0.07463    0  -0.100    0  -0.150  0.170  0.170  0.206  0.0015  -0.0010   0.0013  -0.0007  0.00110         0  0.0030   3.24933   3.32556   3.57016   4.28959   4.36597   4.37890   3.37039  0.315   0.040  0.325  0.137  0.74  0.860   503.0  -2.657   0.625094   0.767876       0.396       0.468        0.468   0.425   -0.126   0.028	
0.500  8.20   3.891024  -1.115  -0.0037  3.210  0.039  3.210   0.0037   2.339  -0.011  -0.48  0.07213    0  -0.080    0  -0.150  0.170  0.170  0.220  0.0015  -0.0011   0.0009  -0.0007  0.00080   0.00020  0.0027   2.98178   3.13343   3.35516   3.93215   4.07791   4.03937   3.15641  0.416   0.097  0.325  0.137  0.66  0.800   456.6  -2.669   0.634353   0.727687       0.396       0.451        0.451   0.375   -0.079   0.022	
0.600  8.20   3.603944  -1.071  -0.0035  3.210  0.038  3.210   0.0033   2.217  -0.015  -0.49  0.06975    0  -0.060    0  -0.150  0.170  0.170  0.225  0.0015  -0.0012   0.0006  -0.0007  0.00060   0.00020  0.0025   2.77838   2.92152   3.09216   3.61493   3.81455   3.73663   2.95835  0.499   0.145  0.325  0.137  0.59  0.780   430.3  -2.599   0.580573   0.700753       0.396       0.438        0.438   0.345   -0.041   0.016	
0.750  8.15   3.182906  -1.020  -0.0032  3.210  0.037  3.210   0.0027   1.946  -0.021  -0.50  0.06713    0  -0.047    0  -0.150  0.170  0.170  0.217  0.0014  -0.0011   0.0003  -0.0007  0.00040   0.00020  0.0022   2.47799   2.53804   2.65718   3.17852   3.43910   3.29299   2.65564  0.600   0.197  0.325  0.137  0.50  0.730   410.5  -2.401   0.498170   0.686168       0.396       0.420        0.420   0.300    0.005   0.009	
1.000  8.10   2.557081  -0.950  -0.0029  3.210  0.035  3.210   0.0019   1.416  -0.028  -0.51  0.06325    0  -0.035    0  -0.150  0.170  0.170  0.185  0.0013  -0.0008   0.0001  -0.0008  0.00020   0.00010  0.0019   1.92518   1.96256   2.14585   2.57218   2.80555   2.64751   2.06665  0.731   0.269  0.325  0.137  0.41  0.690   400.0  -1.955   0.458180   0.630800       0.396       0.396        0.396   0.240    0.065   0.000	
1.500  8.05   1.641810  -0.860  -0.0026  3.210  0.034  3.210   0.0008   0.394  -0.041  -0.52  0.05887    0  -0.018    0  -0.130  0.170  0.170  0.083  0.0014  -0.0004  -0.0001  -0.0008  0.00010         0  0.0016   0.99242   1.35679   1.34990   1.64993   1.85463   1.68417   1.33157  0.748   0.347  0.312  0.113  0.33  0.620   400.0  -1.025   0.499461   0.315091       0.379       0.379        0.379   0.230    0.065   0.000	
2.000  8.00   1.079113  -0.820  -0.0024  3.210  0.032  3.210        0  -0.417  -0.050  -0.53  0.05875    0  -0.010    0  -0.110  0.170  0.170  0.045  0.0015   0.0002        0  -0.0007  0.00020         0  0.0014   0.46763   0.81801   0.81478   1.06575   1.30203   1.10019   0.76066  0.761   0.384  0.302  0.096  0.30  0.560   400.0  -0.299   0.477697   0.257317       0.366       0.366        0.366   0.230    0.065   0.000	
2.500  7.95   0.669409  -0.798  -0.0022  3.210  0.031  3.210        0  -0.725  -0.057  -0.54  0.05975    0  -0.005    0  -0.095  0.170  0.170  0.026  0.0014   0.0004        0  -0.0007  0.00020  -0.00015  0.0012   0.05790   0.43889   0.39788   0.63103   0.80170   0.67373   0.36483  0.770   0.397  0.295  0.082  0.27  0.520   400.0       0   0.495482   0.214492       0.356       0.356        0.356   0.230    0.065   0.000	
3.000  7.90   0.426432  -0.793  -0.0021  3.130  0.030  3.130        0  -0.695  -0.065  -0.54  0.05912    0       0    0  -0.085  0.170  0.170  0.035  0.0014   0.0007   0.0003  -0.0007  0.00040  -0.00020  0.0011  -0.13913   0.10455   0.10460   0.38818   0.59579   0.41262   0.16882  0.778   0.404  0.289  0.072  0.25  0.495   400.0       0   0.451436   0.277756       0.348       0.348        0.348   0.240    0.065   0.000	
4.000  7.85   0.104694  -0.793  -0.002   2.985  0.029  2.985        0  -0.638  -0.077  -0.54  0.05037    0       0    0  -0.073  0.170  0.170  0.053  0.0014   0.0010   0.0007  -0.0006  0.00060  -0.00015  0.0010  -0.30296  -0.15972  -0.23242   0.01644   0.35222   0.00970  -0.03231  0.790   0.397  0.280  0.055  0.22  0.430   400.0       0   0.322365   0.219125       0.335       0.335        0.335   0.270    0.065   0.000	
5.000  7.80  -0.124387  -0.793  -0.002   2.818  0.028  2.818        0  -0.597  -0.088  -0.54  0.04287    0       0    0  -0.065  0.170  0.170  0.072  0.0014   0.0013   0.0014  -0.0004  0.00080  -0.00005  0.0010  -0.40939  -0.20626  -0.57223  -0.28023   0.18743  -0.27152  -0.15158  0.799   0.378  0.273  0.041  0.19  0.400   400.0       0   0.193767   0.000637       0.324       0.324        0.324   0.300    0.065   0.000	
6.000  7.80  -0.299426  -0.793  -0.002   2.682  0.027  2.682        0  -0.561  -0.098  -0.54  0.03788    0       0    0  -0.060  0.170  0.170  0.086  0.0014   0.0015   0.0015  -0.0003  0.00110         0  0.0010  -0.50103  -0.32229  -0.86305  -0.48220  -0.12426  -0.45911  -0.22172  0.807   0.358  0.267  0.030  0.17  0.370   400.0       0   0.126571  -0.062169       0.314       0.314        0.314   0.320    0.065   0.000	
7.500  7.80  -0.507451  -0.793  -0.002   2.515  0.026  2.515        0  -0.530  -0.110  -0.54  0.03162    0       0    0  -0.055  0.170  0.170  0.115  0.0014   0.0017   0.0015  -0.0002  0.00140   0.00010  0.0010  -0.62091  -0.42231  -1.17731  -0.75661  -0.33163  -0.68215  -0.33381  0.817   0.333  0.259  0.017  0.14  0.320   400.0       0   0.051240  -0.177360       0.301       0.301        0.301   0.350    0.065   0.000	
10.00  7.80  -0.757705  -0.793  -0.002   2.300  0.025  2.300        0  -0.486  -0.127  -0.54  0.02413    0       0    0  -0.045  0.170  0.170  0.151  0.0014   0.0017   0.0015  -0.0001  0.00170   0.00020  0.0010  -0.62208  -0.59085  -1.40701  -1.08704  -0.67834  -0.91734  -0.54408  0.829   0.281  0.250      0  0.10  0.280   400.0       0  -0.190318  -0.251548       0.286       0.286        0.286   0.350    0.065   0.000
""")


class AbrahamsonGulerce2022SInter(abrahamson_gulerce_2020.AbrahamsonGulerce2020SInter):
    """
    Updates AbrahamsonGulerce2020 with coefficients from Abrahamson
    and Gulerce (2022, Earthquake Spectra Volume 38, Number 4, pages
    2638–2681, https://doi.org/10.1177/87552930221114374).
    """
    COEFFS = coeffs_2022


class AbrahamsonGulerce2022SSlab(abrahamson_gulerce_2020.AbrahamsonGulerce2020SSlab):
    """
    Updates AbrahamsonGulerce2020 with coefficients from Abrahamson
    and Gulerce (2022, Earthquake Spectra Volume 38, Number 4, pages
    2638–2681, https://doi.org/10.1177/87552930221114374).
    """
    COEFFS = coeffs_2022


for region in abrahamson_gulerce_2020.SUPPORTED_REGIONS[1:]:
    add_alias("AbrahamsonGulerce2022SInter" + abrahamson_gulerce_2020.REGION_ALIASES[region],
              AbrahamsonGulerce2022SInter,
              region=region)
    add_alias("AbrahamsonGulerce2022SSlab" + abrahamson_gulerce_2020.REGION_ALIASES[region],
              AbrahamsonGulerce2022SSlab,
              region=region)
